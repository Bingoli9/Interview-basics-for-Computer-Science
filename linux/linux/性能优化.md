## 性能优化

### 分析系统瓶颈（top）
进入交互模式后:  
输入M，进程列表按内存使用大小降序排序，便于我们观察最大内存使用者使用有问题（检测内存泄漏问题）;  
输入P，进程列表按CPU使用大小降序排序，便于我们观察最耗CPU资源的使用者是否有问题；  

top第三行显示当前系统的，其中有两个值很关键:  
%id：空闲CPU时间百分比，如果这个值过低，表明系统CPU存在瓶颈；  
%wa：等待I/O的CPU时间百分比，如果这个值过高，表明IO存在瓶颈；  


### 分析IO瓶颈 （iostat）

- 如果%iowait的值过高，表示硬盘存在I/O瓶颈。
- 如果 %util 接近 100%，说明产生的I/O请求太多，I/O系统已经满负荷，该磁盘可能存在瓶颈。
- 如果 svctm 比较接近 await，说明 I/O 几乎没有等待时间；
- 如果 await 远大于 svctm，说明I/O 队列太长，io响应太慢，则需要进行必要优化。
- 如果avgqu-sz比较大，也表示有大量io在等待。