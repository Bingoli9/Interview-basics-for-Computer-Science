## 首次访问性能优化

- 减少首屏可交互时间（首次访问）
- 减少不必要内存占用或尽可能利用空闲内存
- 减少首屏可交互时间（二次访问）

### 减少首屏可交互时间（首次访问）

###### 减少首屏资源请求数 

- 合并图片
- 合并css、js
- 以base64方式引入图片资源
- 以css3、svg、canvas、矢量图标替代外链图片
- 图片懒加载
- 脚本、样式按需加载

###### 减少首屏资源请求量

- 对html、静态资源压缩
- 对cookie优化（减少请求上传数据大小）
- 复杂动画优先使用时屏，简单动画优先用帧动画
- 接口返回数据优化

###### 减少每个资源加载前耗时

- Queue

  排队等待时间，包括资源优先级评估、受tcp连接数限制、等待tcp连接释放

- stalled

  阻塞时间，包括队列时间和代理服务器连接时间

- DNS Lookup

  dns轮询时间

- Initial Connection

  初始化连接时间，包括tcp连接以及ssl连接时间

- Request Sent

  请求发送时间

- TTFB

  首字节请求时间，浏览器从发起请求到接受到资源的首个字节时间，收到网络稳定性、后段代码逻辑、服务器带宽与服务器距离等影响

- Content Download

  资源下载时间



减少Queue和stalled耗时

- 使用http2；(关于http2的解读请右转深入浅出http2，coming soon)
- 静态资源存在不同的域名下，避免受到浏览器对tcp连接数的限制

减少DNS Lookup耗时

- DNS预解析
- 部署多台DNS解析服务器

减少initial Connection耗时

- tcp/tls预连接，预先完成DNS轮询、tcp连接、ssl/tls连接 - preconnect(ie不支持)

减少Request sent时间

- 减少不必要的cookie随着请求发出去
  为静态资源分配的域名不应该与接口、html文档所在的域名同域，不然每次请求静态资源都需要带上登录态等cookie信息。
- 合理利用post方式的请求
- 避免发送预检请求

减少TTFB时间

- 部署CDN
  好的cdn会大大减少TTFB时间，有缓存的时候避免了用户/节点去源站拉取资源。
- 使用redis/memcache来缓存数据
  有缓存队列的情况下，避免了后端去数据库拿数据，建立与数据库的连接也是很耗时的
- 升级语言版本

减少Content Download

- 资源压缩

减少js加载和执行的耗时

1）减少js加载（可执行之前）耗时；

- 压缩js
- 加快css的加载和解析；
  外部css的加载和解析会阻塞后续异步加载型脚本的加载
  外部css的加载和解析会阻塞后续同步脚本的执行
  避免样式深层嵌套，书写规范符合css解析器是从右向左解析的规则
- 加快html的加载和解析
  避免深层嵌套
  js模版尽量不要放在html文件中
  2）减少js执行耗时
- for循环优化
  减少循环体执行内容
  减少循环次数 - 超过1000次的循环可以利用达夫设备(一个循环体相当于执行8次循环)来解决
  变量缓存
- 避免使用浏览器插件